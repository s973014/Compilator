# Текстовый редактор с языковым процессором

## Описание
Данная программа представляет собой текстовый редактор с возможностью анализа введённого текста с помощью встроенного языкового процессора. Программа включает стандартные функции редактирования текста, а также инструменты для работы с файлами, настройки интерфейса и отображения результатов анализа кода.

## Основные функции
### Работа с файлами:
- **Создать** – создаёт новый текстовый документ (не сохраняется автоматически).
- **Открыть** – загружает текстовый файл, выбранный пользователем.
- **Сохранить** – сохраняет текущий файл, если он уже существует; в противном случае открывается диалоговое окно для сохранения.
- **Сохранить как...** – открывает диалоговое окно для выбора имени и места сохранения файла.
- **Закрыть файл** – закрывает текущий документ; при наличии несохранённых изменений предлагает их сохранить.
- **Выход** – завершает работу программы; если есть несохранённые файлы, предлагает их сохранить.

### Редактирование текста:
- **Отменить** – отменяет последнее действие.
- **Повторить** – повторяет последнее действие.
- **Вырезать** – удаляет выделенный текст и помещает его в буфер обмена.
- **Копировать** – копирует выделенный текст в буфер обмена.
- **Вставить** – вставляет текст из буфера обмена в текущий документ.
- **Удалить** – удаляет выделенный текст без сохранения в буфер обмена.
- **Выделить всё** – выделяет весь текст в документе.

### Дополнительные функции:
- **Пуск** – запускает анализатор текста, который проверяет введённый код на ошибки и выводит результаты в области отображения.
- **Быстрые команды** – панель с кнопками для быстрого доступа к основным функциям (создание, открытие, сохранение, отмена, копирование, пуск и др.).
- **Параметры** – настройки программы, включая выбор размера текста (10, 11, 12, 14, 16, 18, 20) и языка интерфейса (русский, английский).
- **Справка** – открывает раздел справки с описанием всех функций программы.
- **О программе** – показывает информацию о версии программы и разработчике.

## Интерфейс
Программа состоит из нескольких ключевых областей:
1. **Область ввода/редактирования текста** – основная зона для работы с текстом. Позволяет вводить и редактировать текст, применять команды редактирования.
2. **Область отображения результатов работы языкового процессора** – отображает ошибки и предупреждения после нажатия кнопки «Пуск». Ввод текста в этой области запрещён.
3. **Панель инструментов** – содержит кнопки быстрых команд для удобного управления программой.

## Грамматика
```ebnf
G[START]:
1. <START> -> 'const'<SPACE>
2. <SPACE> -> '_'<FIRST>
3. <FIRST> -> StartSymbols<VAR>
4. <VAR> -> Name<VARREM>
5. <VARREM> -> Name<VARREM>
6. <VARREM> -> ':'<TYPE>
7. <TYPE> -> 'integer'<EQUAL>
8. <EQUAL> -> '='<NUMBER>
9. <NUMBER> -> '+'<UNSIGNEDNUM>
10. <NUMBER> -> '-'<UNSIGNEDNUM>
11. <NUMBER> -> digit <NUMBERREM>
12. <UNSIGNEDNUM> -> digit <NUMBERREM>
13. <NUMBERREM> -> digit <NUMBERREM>
14. <NUMBERREM> -> ';'

StartSymbols -> 'a'|'b'|'c'|...|'z'|'A'|'B'|'C'|...|'Z'|'_'
Name -> 'a'|'b'|'c'|...|'z'|'A'|'B'|'C'|...|'Z'|'1'|'2'|'3'|'4'|'5'|'6'|'7'|'8'|'9'|'0'|'_'
Digit -> '1'|'2'|'3'|'4'|'5'|'6'|'7'|'8'|'9'|'0'

Z = <START>;
VT = {a,b,c,...,z,A,B,C,...,Z,_,=,+,-,;,0,1,2,...,9};
VN = {<START>,<SPACE>,<VAR>,<FIRST>,<VARREM>,<TYPE>,<EQUAL>,<NUMBER>,<UNSIGNEDNUM>,<NUMBERREM>};
```

Согласно классификации Хомского грамматика ``` G[START] ``` является автоматной. 

## Примеры допустимых строк

```Pascal
const n:integer = 12;
const QWE : integer= 1233;
const abc :integer=99;
```

## Диаграмма состояний сканера

![Image alt](https://github.com/s973014/imgs/blob/main/Syntax%20analyzer.png)

## Тестовые примеры
```Pascal
const n:integer = 12;
```
![Alt-текст](https://github.com/s973014/imgs/blob/main/Example1.PNG)
  
```Pascal
Const Int:integer= 10;
```
![Alt-текст](https://github.com/s973014/imgs/blob/main/Example2.PNG)
  
```Pascal
const a:integer = 1;
const b:integer = 2;
```
![Alt-текст](https://github.com/s973014/imgs/blob/main/Example3.PNG)

## Использование
1. Откройте или создайте новый текстовый документ.
2. Введите текст в область редактирования.
3. Используйте команды редактирования, если необходимо.
4. Запустите анализатор текста, нажав «Пуск».
5. Ознакомьтесь с результатами в области отображения ошибок.
6. Сохраните изменения перед закрытием программы.

## Лабораторная работа 5. Поддержка грамматики выражений G[E] и генерация ПОЛИЗ
В рамках расширения функциональности редактора реализована возможность анализа арифметических выражений по КС-грамматике G[<E>], а также генерации их внутреннего представления в виде польской инверсной записи (ПОЛИЗ).
```ebnf
1. E → T A  
2. A → ε | + T A | - T A  
3. T → O B  
4. B → ε | * O B | / O B  
5. O → num | ( E )  
6. num → digit {digit}
```
## Описание:
1. Реализация парсера: грамматика реализована методом рекурсивного спуска.
2. Лексический анализ: перед синтаксическим анализом производится разбор на лексемы (числа, операторы, скобки).
3. Синтаксический анализ: производится проверка корректности введённого выражения согласно правилам грамматики.
4. Генерация ПОЛИЗ: при успешном синтаксическом анализе строится выражение в форме обратной польской записи, пригодное для интерпретации.
## Обработка ошибок:
- **При обнаружении ошибки в структуре выражения** (например, пропущенной закрывающей скобке или неверном расположении оператора), анализатор выдаёт соответствующее сообщение с указанием позиции.
- **Лексические ошибки** (например, недопустимые символы) также выявляются и отображаются в области результатов.
## Использование:
1. Введите арифметическое выражение в окно редактора.
2. Нажмите кнопку «ПОЛИЗ».
3. В области результатов отобразятся:
- **Лексемы и их типы.**
- **Сообщения об ошибках (при наличии).**
- **Построенное выражение в виде ПОЛИЗ (если ошибок нет).**
# Реализация алгоритма поиска подстрок с помощью регулярных выражений.
### Лабораторная работа 6. 
Поставнока задачи - Реализовать алгоритм поиска в тексте подстрок, соответствующих заданным регулярным выражениям. Используя библиотечные реализации (например, класс Regex в C#), решить 3 задачи в соответствии с персональным вариантом.
Необходимо встроить разработанные алгоритмы в интерфейс текстового редактора, разработанного на первой лабораторной работе. 
Исходные данные – текст, содержащий данные заданного формата. Выходные данные – найденные выражения с указанием позиции начала. Возможно выделение подстрок в исходном тексте. (Задания: 29, 9, 5)
### Решение трёх задач:
1. Поиск цитат в кавычках (русские и английские кавычки) <br>
Решение:<br>
```
"[\"“”«»](.*?)[\"“”«»]"
```
2. Поиск номеров карт "Мир": начинаются с 2200–2204 и всего 16 цифр<br>
Решение:<br>
```
"\b(220[0-4]\d{12})\b"
```
3. Поиск дат в формате DD/MM/YYYY с проверкой високосных лет<br>
Решение:<br>
```
@"\b(?:(?:31/(?:0?[13578]|1[02]))|(?:29|30)/(?:0?[13-9]|1[0-2]))/((?:19|20)\d{2})" +
@"|(?:29/0?2/((?:(?:19|20)(?:[02468][048]|[13579][26]))))" +
@"|(?:0?[1-9]|1\d|2[0-8])/(?:0?[1-9]|1[0-2])/((?:19|20)\d{2})\b"
```
### Тестовые примеры:
![image](https://github.com/user-attachments/assets/7d51e0ab-9ce6-4496-8d08-bffd24d1758f)
![image](https://github.com/user-attachments/assets/9d3384b7-9810-4b10-8e7f-15138a6c9915)
![image](https://github.com/user-attachments/assets/e54c242a-f87d-48df-8463-d5ce0422e243)
